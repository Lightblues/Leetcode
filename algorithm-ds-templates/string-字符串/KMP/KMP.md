## KMP

- <https://oi-wiki.org/string/kmp/>

关键是「部分匹配表/失配函数」, 也即匹配失败之后下一个要匹配的位置.

- 部分匹配表，又称为失配函数，作用是让算法无需多次匹配S中的任何字符。能够实现线性时间搜索的关键是在主串的一些字段中检查模式串的初始字段，可以确切地知道在当前位置之前的一个潜在匹配的位置。换句话说，在不错过任何潜在匹配的情况下，"预搜索"这个模式串本身并将其译成一个包含所有可能失配的位置对应可以绕过最多无效字符的列表。
- 例如, 对于 aaa, 字符串的前缀函数应该是 `pi=[0,1,2]`, 定义为 s[0...i] 的 真前缀和后缀相等的最大长度 (显然 pi[0]=0)
- 而其 `nxt=[-1,0,1]`, 这是为了和编程语言中数组从0开始index保持一致. 例如当要匹配第2个元素时, 若失败, 可知 s[0...2] 的前缀函数值为2
- 在下面的 search函数中, 遍历的j表示当前匹配到了字符串a的多少长度
